<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sesli Harfleri √ñƒürenelim - Burak √ñƒüretmen</title>
    <link href="https://fonts.googleapis.com/css2?family=Balsamiq+Sans:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --ana: #ff7675; --iyi: #55efc4; --bg: #f0f3f7; --koyu: #2d3436; --kirmizi: #e84118; }
        
        /* ƒ∞MLE√á AYARI */
        * { cursor: pointer !important; -webkit-tap-highlight-color: transparent; }

        body { 
            font-family: 'Balsamiq Sans', cursive, sans-serif;
            background: var(--bg); 
            margin: 0; 
            overflow: hidden; 
            user-select: none; 
            touch-action: manipulation;
        }
        
        /* Gƒ∞Rƒ∞≈û EKRANI */
        #giris-ekrani, #bitis-ekrani {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(180deg, #74b9ff, #a29bfe); 
            display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 1000;
            transition: transform 0.8s cubic-bezier(0.77, 0, 0.175, 1);
        }

        #bitis-ekrani { display: none; z-index: 2000; background: linear-gradient(135deg, #00b894, #0984e3); }

        /* --- SAHNE TASARIMI --- */
        .sahne-konteyner {
            position: relative;
            display: flex;
            justify-content: center; 
            margin-bottom: 30px;
            transform: scale(1.1);
            padding-top: 40px; /* S√ºsler i√ßin yer */
            overflow: visible; 
            padding-bottom: 20px;
        }

        /* KAR EFEKTƒ∞ ALANI */
        .kar-alani {
            position: absolute;
            top: -100px; left: -50%; width: 200%; height: 150%;
            pointer-events: none;
            z-index: 0;
        }
        .kar-tanesi {
            position: absolute;
            background: white;
            border-radius: 50%;
            opacity: 0.8;
            animation: karYagisi linear infinite;
            top: -10px;
        }
        @keyframes karYagisi {
            to { transform: translateY(600px); } 
        }

        .tahta {
            background-color: #2f3640;
            border: 10px solid #d35400;
            border-radius: 10px;
            padding: 30px 40px;
            box-shadow: 0 15px 25px rgba(0,0,0,0.25);
            color: #f5f6fa;
            font-size: 38px;
            font-weight: bold;
            letter-spacing: 5px;
            text-align: center;
            font-family: 'Balsamiq Sans', cursive;
            min-width: 260px;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.3);
            position: relative;
            z-index: 2; 
        }

        /* --- S√úSLER (BAYRAKLAR) --- */
        .sus-ipi {
            position: absolute;
            top: 2px; /* Tahtanƒ±n √ºst√ºne denk gelecek ≈üekilde */
            left: -15px; 
            width: calc(100% + 30px);
            height: 40px;
            display: flex;
            justify-content: space-between;
            z-index: 10;
        }

        /* ƒ∞p G√∂r√ºn√ºm√º */
        .sus-ipi::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%;
            height: 15px;
            border-top: 3px solid rgba(255,255,255,0.9);
            border-radius: 50% 50% 0 0 / 100% 100% 0 0; 
        }

        .bayrak {
            width: 30px;
            height: 35px;
            clip-path: polygon(0 0, 100% 0, 50% 100%); /* √ú√ßgen ≈üekli */
            transform-origin: top center;
            animation: bayrakSalla 3s infinite ease-in-out alternate;
            position: relative;
            top: 2px;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.2));
        }

        /* KIRMIZI - BEYAZ SIRALAMA */
        .bayrak:nth-child(odd) { 
            background-color: var(--kirmizi); /* Tek sayƒ±lar Kƒ±rmƒ±zƒ± */
            animation-duration: 3.2s;
        }
        .bayrak:nth-child(even) { 
            background-color: #ffffff; /* √áift sayƒ±lar Beyaz */
            animation-duration: 2.5s;
        }

        @keyframes bayrakSalla {
            0% { transform: rotate(-8deg); }
            100% { transform: rotate(8deg); }
        }

        /* --- YAZI Tƒ∞Pƒ∞ --- */
        .baslik-kapsayici { 
            text-align: center; 
            background: rgba(255,255,255,0.95); 
            padding: 25px 50px; 
            border-radius: 50px; 
            z-index: 2; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.15), inset 0 -5px 0 rgba(0,0,0,0.05); 
            border: 6px solid #fff;
            width: 85%; max-width: 550px;
            margin-top: 10px;
        }
        
        .baslik-kapsayici h1 {
            color: var(--ana);
            margin: 0;
            font-size: 48px;
            line-height: 1.2;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
            letter-spacing: 1px;
        }

        .baslik-kapsayici p {
            color: #636e72;
            margin: 15px 0 0 0;
            font-size: 22px;
            text-transform: none;
            font-weight: bold;
        }
        
        .ana-buton {
            padding: 20px 60px; font-size: 32px; font-weight: bold; font-family: 'Balsamiq Sans', sans-serif;
            background: #fdcb6e; color: #2d3436; border: none;
            border-radius: 100px; box-shadow: 0 10px 0 #e17055;
            z-index: 10; margin-top: 35px; transition: 0.2s;
            text-transform: uppercase; letter-spacing: 1px;
        }
        .ana-buton:active { transform: translateY(6px); box-shadow: 0 4px 0 #e17055; }

        /* OYUN ALANI */
        #oyun-alani { 
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: flex-start; 
            padding-top: 40px; 
        }

        /* SAHNE */
        #sahne-alani {
            position: relative; width: 320px; height: 250px;
            background: #1e272e; border: 10px solid #57606f;
            border-radius: 30px; overflow: hidden; 
            margin-bottom: 20px; 
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
            flex-shrink: 0;
        }

        .perde {
            position: absolute; top: 0; width: 51%; height: 100%;
            background: #b33939; z-index: 5; 
            transition: transform 1.5s cubic-bezier(0.45, 0.05, 0.55, 0.95);
            box-shadow: inset 0 0 40px rgba(0,0,0,0.7);
            pointer-events: none; 
        }
        .perde.sol { left: 0; border-right: 2px solid #822727; }
        .perde.sag { right: 0; border-left: 2px solid #822727; }

        .perde-acik.sol { transform: translateX(-100%); }
        .perde-acik.sag { transform: translateX(100%); }

        .ipucu-el {
            position: absolute; z-index: 10; font-size: 60px; color: white;
            top: 50%; left: 50%; transform: translate(-50%, -50%);
            animation: tiklaEfekt 1.5s infinite; pointer-events: none;
            text-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        @keyframes tiklaEfekt {
            0% { transform: translate(-50%, -50%) scale(1); opacity: 0.8; }
            50% { transform: translate(-50%, -50%) scale(1.3); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 0.8; }
        }

        .harf-etiket { font-size: 160px; font-weight: 700; color: white; text-shadow: 0 0 25px rgba(255,255,255,0.4); z-index: 2; text-transform: lowercase; }

        /* BALONLAR */
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; opacity: 0; pointer-events: none; transition: 0.8s; width: 95%; max-width: 600px; }
        .grid.aktif { opacity: 1; pointer-events: auto; }
        
        .balon {
            width: 100%; aspect-ratio: 3/4; border-radius: 50% 50% 50% 50% / 45% 45% 55% 55%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: white; box-shadow: inset -8px -8px 15px rgba(0,0,0,0.15);
            animation: salinim 3s infinite ease-in-out;
            position: relative; 
            transition: transform 0.3s;
        }
        @keyframes salinim { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

        .kart-ikon { font-size: 60px; margin-bottom: 5px; display: flex; align-items: center; justify-content: center; }
        .kart-ikon svg { width: 55px; height: 55px; filter: drop-shadow(0 3px 3px rgba(0,0,0,0.2)); }
        .kart-metin { font-size: 22px; font-weight: 700; text-transform: lowercase; }

        /* Dƒ∞NLENƒ∞YOR MODU */
        .dinleniyor {
            animation: yukselVeYanSon 1s infinite alternate ease-in-out !important;
            z-index: 100;
            border: 4px solid rgba(255,255,255,0.8);
            box-shadow: 0 0 20px rgba(255,255,255,0.6);
        }
        @keyframes yukselVeYanSon {
            0% { transform: translateY(-20px) scale(1.1); filter: brightness(1.1); }
            100% { transform: translateY(-35px) scale(1.15); filter: brightness(1.3); }
        }

        .patla { animation: patlaAnim 0.3s forwards cubic-bezier(0.175, 0.885, 0.32, 1.275); pointer-events: none; }
        @keyframes patlaAnim {
            0% { transform: scale(1); filter: brightness(1); }
            50% { transform: scale(1.5); filter: brightness(2); }
            100% { transform: scale(0); opacity: 0; }
        }

        .tanitim-bandi { 
            position: absolute; bottom: 0; width: 100%; background: rgba(0,0,0,0.75); 
            color: white; padding: 15px 0; overflow: hidden; white-space: nowrap; 
            font-size: 20px; font-weight: bold; border-top: 5px solid #fdcb6e; 
        }
        .kayan-yazi { display: inline-block; padding-left: 100%; animation: kaydir 20s linear infinite; }
        @keyframes kaydir { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        .nav { position: fixed; bottom: 20px; display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; max-width: 95%; }
        .nav-btn { 
            width: 45px; height: 45px; border-radius: 50%; border: 3px solid white; 
            background: #ccc; font-weight: bold; transition: 0.3s;
            font-family: 'Balsamiq Sans', sans-serif; font-size: 18px;
        }
        .nav-btn.aktif { background: var(--ana); color: white; transform: scale(1.2); box-shadow: 0 0 10px rgba(255,118,117,0.5); }

        .konfeti { position: absolute; width: 15px; height: 15px; background: #fff; animation: yagdir 3s linear infinite; }
        @keyframes yagdir { 0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
        
        @media (max-width: 600px) {
            .baslik-kapsayici h1 { font-size: 32px; }
            .baslik-kapsayici p { font-size: 18px; }
            .ana-buton { padding: 15px 40px; font-size: 24px; }
            #sahne-alani { width: 280px; height: 220px; }
            .harf-etiket { font-size: 140px; }
            .grid { gap: 15px; }
            .sahne-konteyner { transform: scale(0.85); }
        }
    </style>
</head>
<body>

<div id="giris-ekrani">
    
    <div class="sahne-konteyner" id="kisSahnesi">
        <div class="kar-alani" id="karAlani"></div>

        <div class="tahta">
            <div class="sus-ipi">
                <div class="bayrak"></div> <div class="bayrak"></div> <div class="bayrak"></div> <div class="bayrak"></div> <div class="bayrak"></div> <div class="bayrak"></div> <div class="bayrak"></div> </div>

            a e ƒ± i<br>o √∂ u √º
        </div>
    </div>

    <div class="baslik-kapsayici">
        <h1>Sesli Harfleri<br>√ñƒürenelim</h1>
        <p>Burak √ñƒüretmen ile Eƒülence Zamanƒ±! üé®</p>
    </div>
    <button id="audio-init-btn" class="ana-buton" onclick="tanitimiBaslat()">Oynat üîä</button>
    <button id="start-game-btn" class="ana-buton" style="display:none; background:var(--iyi); box-shadow: 0 10px 0 #218c74;" onclick="oyunuBaslat()">Hadi Ba≈ülayalƒ±m ‚ñ∂Ô∏è</button>
    <div class="tanitim-bandi">
        <div class="kayan-yazi" style="text-transform:none;">Burak √ñƒüretmenle Okuma √ñƒüreniyorum. &nbsp;&nbsp;&nbsp;&nbsp; - Burak DOƒûRU &nbsp;&nbsp;&nbsp;&nbsp; ‚ú® &nbsp;&nbsp;&nbsp;&nbsp; </div>
    </div>
</div>

<div id="bitis-ekrani">
    <div class="baslik-kapsayici" style="background:white;">
        <h1 style="color:#0984e3; font-size:60px; margin:0;">TEBRƒ∞KLER! üéâ</h1>
        <p style="font-size:30px; color:#2d3436; margin:20px 0;">B√ºt√ºn Harfleri √ñƒürendin!</p>
        <p style="font-size:22px; color:#636e72;">- Burak √ñƒüretmen -</p>
        <button class="ana-buton" style="font-size:20px; margin-top:15px; background:#fdcb6e;" onclick="oyunuYenidenBaslat()">Yeniden Ba≈ülat üîÑ</button>
    </div>
</div>

<div id="oyun-alani">
    <div id="sahne-alani" onclick="sahneTiklama()">
        <div class="perde sol" id="pSol"></div>
        <div class="perde sag" id="pSag"></div>
        <div class="ipucu-el" id="sahneIpucu">üëá</div>
        <div class="harf-etiket" id="anaHarf">a</div>
    </div>
    <div class="grid" id="izgara"></div>
    <div class="nav" id="altNav"></div>
</div>

<script>
    const svgUtu = `<svg viewBox="0 0 512 512" width="55" height="55"><path d="M448 224h-24c-28.5 0-54.6-9.5-75.3-25.2l-40.3-30.2c-29.3-22-64.8-33.6-101.4-33.6H176c-44.2 0-80 35.8-80 80v9h352c17.7 0 32 14.3 32 32v160c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32v-48c0-83.8 64.6-152.6 146.6-159.2 10.9-38.3 46.2-66.8 88.4-66.8h30.1c42.8 0 84.1 13.6 118.2 39.2l40.3 30.2C437.3 190.2 448 206.3 448 224z" fill="#ecf0f1"/><path d="M0 400h448v32c0 8.8-7.2 16-16 16H16c-8.8 0-16-7.2-16-16v-32z" fill="#95a5a6"/></svg>`;
    const svgUn = `<svg viewBox="0 0 512 512" width="55" height="55"><path d="M128 48h256l-32 416H160z" fill="#f5f6fa"/><path d="M128 48c0-17.7 14.3-32 32-32h192c17.7 0 32 14.3 32 32s-14.3 32-32 32H160c-17.7 0-32-14.3-32-32z" fill="#dcdde1"/><text x="256" y="320" font-family="Balsamiq Sans" font-weight="bold" font-size="100" text-anchor="middle" fill="#2f3640">UN</text></svg>`;
    const svgIncir = `<svg viewBox="0 0 512 512" width="55" height="55"><path d="M256 48C160 48 96 128 96 224c0 112 64 240 160 240s160-128 160-240c0-96-64-176-160-176z" fill="#6D214F"/><path d="M256 80c-70 0-120 80-120 160 0 88 50 192 120 192s120-104 120-192c0-80-50-160-120-160z" fill="#B33771"/><circle cx="220" cy="200" r="8" fill="#F8EFBA"/><circle cx="290" cy="220" r="8" fill="#F8EFBA"/><circle cx="256" cy="280" r="8" fill="#F8EFBA"/><circle cx="200" cy="260" r="8" fill="#F8EFBA"/><circle cx="310" cy="180" r="8" fill="#F8EFBA"/><path d="M245 48h22v40h-22z" fill="#009432"/></svg>`;

    const renkler = ['#ff7675', '#74b9ff', '#55efc4', '#fdcb6e', '#a29bfe', '#fab1a0'];
    const veriler = [
        { harf: 'a', ses: 'Kayƒ±t (1)', nesneler: [{n:'arƒ±', i:'üêù', s:'Kayƒ±t (2)'}, {n:'at', i:'üêé', s:'Kayƒ±t (3)'}, {n:'ayakkabƒ±', i:'üëû', s:'Kayƒ±t (4)'}] },
        { harf: 'e', ses: 'Kayƒ±t (5)', nesneler: [{n:'elma', i:'üçé', s:'Kayƒ±t (6)'}, {n:'e≈üek', i:'üê¥', s:'Kayƒ±t (7)'}, {n:'el', i:'üñêÔ∏è', s:'Kayƒ±t (8)'}] },
        { harf: 'ƒ±', ses: 'Kayƒ±t (9)', nesneler: [{n:'ƒ±≈üƒ±k', i:'üí°', s:'Kayƒ±t (10)'}, {n:'ƒ±spanak', i:'ü•¨', s:'Kayƒ±t (11)'}, {n:'ƒ±zgara', i:'üç¢', s:'Kayƒ±t (12)'}] },
        { harf: 'i', ses: 'Kayƒ±t (13)', nesneler: [{n:'inek', i:'üêÑ', s:'Kayƒ±t (14)'}, {n:'incir', i:svgIncir, s:'Kayƒ±t (15)'}, {n:'ila√ß', i:'üíä', s:'Kayƒ±t (16)'}] },
        { harf: 'o', ses: 'Kayƒ±t (17)', nesneler: [{n:'otob√ºs', i:'üöå', s:'Kayƒ±t (18)'}, {n:'okul', i:'üè´', s:'Kayƒ±t (19)'}, {n:'orman', i:'üå≤', s:'Kayƒ±t (20)'}] },
        { harf: '√∂', ses: 'Kayƒ±t (21)', nesneler: [{n:'√∂rdek', i:'ü¶Ü', s:'Kayƒ±t (22)'}, {n:'√∂r√ºmcek', i:'üï∑Ô∏è', s:'Kayƒ±t (23)'}, {n:'√∂ƒüretmen', i:'üë©‚Äçüè´', s:'Kayƒ±t (24)'}] },
        { harf: 'u', ses: 'Kayƒ±t (25)', nesneler: [{n:'u√ßak', i:'‚úàÔ∏è', s:'Kayƒ±t (26)'}, {n:'uyku', i:'üò¥', s:'Kayƒ±t (27)'}, {n:'un', i: svgUn, s:'Kayƒ±t (28)'}] },
        { harf: '√º', ses: 'Kayƒ±t (29)', nesneler: [{n:'√ºz√ºm', i:'üçá', s:'Kayƒ±t (30)'}, {n:'√ºt√º', i: svgUtu, s:'Kayƒ±t (31)'}, {n:'√º√ß', i:'3Ô∏è‚É£', s:'Kayƒ±t (32)'}] }
    ];

    let mevcutIdx = 0, acikIdx = 0;
    let fonMuzigi = new Audio('sesler/Kayƒ±t (99).m4a');
    fonMuzigi.loop = true;
    fonMuzigi.volume = 0.01; 

    let aktifSesObjesi = null;
    let perdeAcikMi = false;
    let tiklamaKilitli = false;

    // WEB AUDIO API
    let audioCtx = null;
    let audioInited = false;

    function sesiOnYukle(dosya) {
        const temp = new Audio(encodeURI(`sesler/${dosya}.m4a`));
        temp.preload = 'auto';
        temp.load();
    }

    function sesCal(dosya, bittiginde) {
        if (aktifSesObjesi) {
            aktifSesObjesi.pause();
            aktifSesObjesi.currentTime = 0;
            aktifSesObjesi = null;
        }

        const s = new Audio(encodeURI(`sesler/${dosya}.m4a`));
        aktifSesObjesi = s;

        // SES Y√úKSELTME: Konu≈ümalar (0-32) VE Biti≈ü Sesi (98)
        const dosyaNo = parseInt(dosya.replace('Kayƒ±t (', '').replace(')', ''));
        const yukselt = (dosyaNo >= 0 && dosyaNo <= 32) || dosyaNo === 98;

        if (yukselt && audioInited && audioCtx) {
            const source = audioCtx.createMediaElementSource(s);
            const gainNode = audioCtx.createGain();
            const compressor = audioCtx.createDynamicsCompressor();

            // Sesi y√ºkselt
            gainNode.gain.value = 10.0; 

            // Patlamalarƒ± engelle (Compressor)
            compressor.threshold.value = -24;
            compressor.knee.value = 30;
            compressor.ratio.value = 12;
            compressor.attack.value = 0.003;
            compressor.release.value = 0.25;

            source.connect(gainNode);
            gainNode.connect(compressor);
            compressor.connect(audioCtx.destination);
        } else {
            s.volume = 1.0; 
        }

        const oynatma = s.play();
        if (oynatma !== undefined) {
            oynatma.then(() => { }).catch(error => {
                console.log("Ses √ßalma hatasƒ±:", error);
                if(bittiginde) bittiginde();
            });
        }

        if (bittiginde) {
            s.onended = () => {
                aktifSesObjesi = null;
                bittiginde();
            };
        }
        return s;
    }

    // KAR YAƒûDIRMA FONKSƒ∞YONU
    function karYagdir() {
        const karAlani = document.getElementById('karAlani');
        for (let i = 0; i < 30; i++) { // 30 adet kar tanesi
            const kar = document.createElement('div');
            kar.className = 'kar-tanesi';
            // Rastgele konum, boyut ve hƒ±z
            kar.style.left = Math.random() * 100 + '%';
            kar.style.width = kar.style.height = (Math.random() * 8 + 4) + 'px';
            kar.style.animationDuration = (Math.random() * 3 + 2) + 's';
            kar.style.animationDelay = Math.random() * 2 + 's';
            karAlani.appendChild(kar);
        }
    }

    function tanitimiBaslat() {
        if (!audioCtx) {
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            audioCtx = new AudioContext();
            audioInited = true;
        }
        if (audioCtx.state === 'suspended') {
            audioCtx.resume();
        }

        document.getElementById('audio-init-btn').style.display = 'none';
        
        sesiOnYukle('Kayƒ±t (1)');
        sesiOnYukle('Kayƒ±t (2)');
        
        fonMuzigi.volume = 0.01; 
        fonMuzigi.play().catch(e => console.log("Fon m√ºziƒüi hatasƒ±"));
        
        sesCal('Kayƒ±t (0)', () => {
            document.getElementById('start-game-btn').style.display = 'block';
        });
    }

    function oyunuBaslat() { 
        // Giri≈ü ekranƒ±nƒ± yukarƒ± kaydƒ±r
        document.getElementById('giris-ekrani').style.transform = 'translateY(-100%)'; 
        // Kar yaƒüƒ±≈üƒ±nƒ± durdur (performans i√ßin)
        setTimeout(() => { document.getElementById('kisSahnesi').style.display = 'none'; }, 800);
    }

    function sahneTiklama() {
        if(tiklamaKilitli) return;

        if (!perdeAcikMi) {
            tiklamaKilitli = true; 
            const ipucu = document.getElementById('sahneIpucu');
            if(ipucu) ipucu.style.display = 'none';

            document.getElementById('pSol').classList.add('perde-acik');
            document.getElementById('pSag').classList.add('perde-acik');
            perdeAcikMi = true;
            
            setTimeout(() => {
                sesCal(veriler[mevcutIdx].ses, () => {
                    document.getElementById('izgara').classList.add('aktif');
                    tiklamaKilitli = false; 
                });
            }, 300);
        } else {
            tiklamaKilitli = true;
            sesCal(veriler[mevcutIdx].ses, () => {
                tiklamaKilitli = false;
            });
        }
    }

    function sistemiKur() {
        const v = veriler[mevcutIdx];
        const anaHarfDOM = document.getElementById('anaHarf');
        anaHarfDOM.innerText = v.harf;
        
        document.getElementById('pSol').classList.remove('perde-acik');
        document.getElementById('pSag').classList.remove('perde-acik');
        document.getElementById('izgara').classList.remove('aktif');
        document.getElementById('sahneIpucu').style.display = 'block';
        perdeAcikMi = false;
        tiklamaKilitli = false;
        
        const izgara = document.getElementById('izgara');
        izgara.innerHTML = '';
        
        v.nesneler.forEach((n, i) => {
            const b = document.createElement('div');
            b.className = 'balon';
            b.style.backgroundColor = renkler[i % renkler.length];
            b.style.animationDelay = `${i * 0.15}s`;
            const ikonIcerik = n.i.includes('<svg') ? n.i : `<div class="kart-ikon">${n.i}</div>`;
            b.innerHTML = `${ikonIcerik}<div class="kart-metin">${n.n}</div>`;
            
            b.onclick = function() {
                if (tiklamaKilitli || this.classList.contains('patla')) return;

                tiklamaKilitli = true;
                this.classList.add('dinleniyor');

                sesCal(n.s, () => {
                    this.classList.remove('dinleniyor');
                    this.classList.add('patla'); 
                    
                    setTimeout(() => {
                        if(document.querySelectorAll('.balon:not(.patla)').length === 0) {
                            if(mevcutIdx === acikIdx && acikIdx < 7) { acikIdx++; }
                            setTimeout(() => { 
                                if(mevcutIdx === 7) { oyunuBitir(); } 
                                else if(mevcutIdx < 7) { mevcutIdx++; sistemiKur(); } 
                            }, 1000);
                        }
                        
                        if(document.querySelectorAll('.balon:not(.patla)').length > 0) {
                             tiklamaKilitli = false;
                        }
                    }, 300);
                });
            };
            izgara.appendChild(b);
        });

        const nav = document.getElementById('altNav');
        nav.innerHTML = '';
        veriler.forEach((x, i) => {
            const btn = document.createElement('button');
            btn.className = `nav-btn ${i === mevcutIdx ? 'aktif' : ''}`;
            btn.innerText = x.harf;
            btn.onclick = () => { 
                if(!tiklamaKilitli) { 
                    document.getElementById('bitis-ekrani').style.display = 'none';
                    mevcutIdx = i; 
                    sistemiKur(); 
                    if(fonMuzigi.paused) fonMuzigi.play();
                } 
            };
            nav.appendChild(btn);
        });
    }

    function oyunuBitir() {
        const bitisEkrani = document.getElementById('bitis-ekrani');
        bitisEkrani.style.display = 'flex';
        
        const eskiKonfetiler = document.querySelectorAll('.konfeti');
        eskiKonfetiler.forEach(k => k.remove());

        for(let i=0; i<50; i++) {
            const k = document.createElement('div');
            k.className = 'konfeti';
            k.style.left = Math.random() * 100 + '%';
            k.style.animationDelay = Math.random() * 2 + 's';
            k.style.backgroundColor = renkler[Math.floor(Math.random() * renkler.length)];
            bitisEkrani.appendChild(k);
        }
        fonMuzigi.volume = 0; 
        sesCal('Kayƒ±t (98)'); 
    }

    function oyunuYenidenBaslat() {
        document.getElementById('bitis-ekrani').style.display = 'none';
        mevcutIdx = 0;
        acikIdx = 0; 
        tiklamaKilitli = false;
        sistemiKur();
        fonMuzigi.volume = 0.01;
        fonMuzigi.currentTime = 0;
        fonMuzigi.play();
    }

    window.onload = function() {
        sistemiKur();
        karYagdir(); 
    };
</script>
</body>
</html>
